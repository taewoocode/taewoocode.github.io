!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(g.yDrawer||(g.yDrawer={})).vanilla=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){(function(global){"use strict";function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!==(void 0===call?"undefined":_typeof2(call))&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+(void 0===superClass?"undefined":_typeof2(superClass)));subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function createEvent(eventName){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return new CustomEvent(eventName,data)}catch(e){var event=document.createEvent("CustomEvent");return event.initCustomEvent(eventName,!0,!0,data.detail),event}}function setupProperty(key,sideEffect){var _this=this;def(this,key,{enumerable:!0,get:function(){return _this[STATE][key]},set:function(value){null!=sideEffect?sideEffect(value):_this.setState(key,value)}})}function setupProperties(){var _this2=this,sideEffects=this.sideEffects();Object.keys(this[STATE]).forEach(function(key){if(void 0===_this2[key]){var sideEffect=sideEffects[key];setupProperty.call(_this2,key,sideEffect)}})}var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return void 0===obj?"undefined":_typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":void 0===obj?"undefined":_typeof2(obj)},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Mix=function Mix(){_classCallCheck(this,Mix)},_Symbol=global.Symbol||function(x){return"_"+x},def=Object.defineProperty.bind(Object),ROOT=_Symbol("root"),STATE=_Symbol("state");exports.default=function(){var C=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mix;return function(_C){function _class(){return _classCallCheck(this,_class),_possibleConstructorReturn(this,(_class.__proto__||Object.getPrototypeOf(_class)).apply(this,arguments))}return _inherits(_class,_C),_createClass(_class,[{key:"getComponentName",value:function(){throw Error("Component needs to have a name, e.g. `my-tag`. Override `getComponentName`")}},{key:"setupComponent",value:function(el,state){return def(this,STATE,{value:Object.assign({},this.defaults(),state)}),setupProperties.call(this),def(this,ROOT,{value:this.setupDOM(el)}),this}},{key:"setupDOM",value:function(el){return el}},{key:"getRoot",value:function(){return this[ROOT]}},{key:"getEl",value:function(){return this[ROOT]}},{key:"fireEvent",value:function(eventName,data){var eventNameNS=this.componentName+"-"+eventName;this.el.dispatchEvent(createEvent(eventNameNS,data))}},{key:"defaults",value:function(){return console.warn("defaults not provided"),{}}},{key:"sideEffects",value:function(){return console.warn("sideEffects not provided"),{}}},{key:"setState",value:function(keyOrMap,value){if("string"==typeof keyOrMap)this.setStateKV(keyOrMap,value);else{if("object"!==(void 0===keyOrMap?"undefined":_typeof(keyOrMap)))throw Error("setState needs argument");this.setStateMap(keyOrMap)}}},{key:"setStateKV",value:function(key,value){this[STATE][key]=value}},{key:"setStateMap",value:function(map){var _this4=this;Object.keys(this[STATE]).forEach(function(key){_this4.setStateKV(key,map[key])})}},{key:"componentName",get:function(){return this.getComponentName()}},{key:"root",get:function(){return this.getRoot()}},{key:"el",get:function(){return this.getEl()}}]),_class}(C)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(require,module,exports){"use strict";function linearTween(t,b,c,d){return c*t/d+b}function pageDist(p1,p2){return Math.sqrt(Math.pow(p1.pageX-p2.pageX,2)+Math.pow(p1.pageY-p2.pageY,2))}function contains(target,className){for(var t=target;null!=t;){if(t.classList&&t.classList.contains(className))return!0;t=t.parentNode}return!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearTween=linearTween,exports.pageDist=pageDist,exports.contains=contains},{}],3:[function(require,module,exports){(function(global){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!==(void 0===call?"undefined":_typeof(call))&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+(void 0===superClass?"undefined":_typeof(superClass)));subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_componentCore2=require("y-component/src/component-core"),_componentCore3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_componentCore2),_common=require("../common"),_Symbol=global.Symbol||function(x){return"_"+x},IDLE=_Symbol("idle"),TOUCHING=_Symbol("touching"),START_ANIMATING=_Symbol("startAnimating"),ANIMATING=_Symbol("animating"),def=Object.defineProperty.bind(Object);exports.default=function(C){return function(_componentCore){function _class(){return _classCallCheck(this,_class),_possibleConstructorReturn(this,(_class.__proto__||Object.getPrototypeOf(_class)).apply(this,arguments))}return _inherits(_class,_componentCore),_createClass(_class,[{key:"getComponentName",value:function(){return"y-drawer"}},{key:"defaults",value:function(){return{opened:!1,transitionDuration:200,persistent:!1}}},{key:"sideEffects",value:function(){var _this2=this;return{opened:function(o){!0===o?_this2.open():_this2.close()},persistent:function(d){!0===d?_this2.persist():_this2.unpersist()}}}},{key:"setupComponent",value:function(el,props){return _get(_class.prototype.__proto__||Object.getPrototypeOf(_class.prototype),"setupComponent",this).call(this,el,props),this.cacheDOMElements(),this.defProperties(),this.bindCallbacks(),this.jumpTo(this.opened),this.persistent||this.addEventListeners(),this.persistent&&(this.scrim.style.display="none"),this}},{key:"cacheDOMElements",value:function(){def(this,"scrim",{value:this.root.querySelector(".y-drawer-scrim")}),def(this,"content",{value:this.root.querySelector(".y-drawer-content")})}},{key:"defProperties",value:function(){def(this,"startX",{value:0,writable:!0}),def(this,"startY",{value:0,writable:!0}),def(this,"pageX",{value:0,writable:!0}),def(this,"pageY",{value:0,writable:!0}),def(this,"lastPageX",{value:0,writable:!0}),def(this,"lastPageY",{value:0,writable:!0}),def(this,"isScrolling",{writable:!0}),def(this,"startedMoving",{value:!1,writable:!0}),def(this,"loopState",{value:IDLE,writable:!0}),def(this,"velocity",{value:0,writable:!0}),def(this,"startTranslateX",{value:0,writable:!0}),def(this,"translateX",{value:0,writable:!0}),def(this,"animationFrameRequested",{value:!1,writable:!0}),def(this,"touching",{value:!1,writable:!0}),def(this,"lastTime",{writable:!0}),def(this,"sliderWidth",{writable:!0}),def(this,"animation",{writable:!0,configurable:!0})}},{key:"bindCallbacks",value:function(){def(this,"touchStartCallback",{value:this.touchStartCallback.bind(this)}),def(this,"touchMoveCallback",{value:this.touchMoveCallback.bind(this)}),def(this,"touchEndCallback",{value:this.touchEndCallback.bind(this)}),def(this,"scrimClickCallback",{value:this.scrimClickCallback.bind(this)}),def(this,"animationFrameCallback",{value:this.animationFrameCallback.bind(this)})}},{key:"addEventListeners",value:function(){document.addEventListener("touchstart",this.touchStartCallback,{passive:!1}),document.addEventListener("touchmove",this.touchMoveCallback,{passive:!1}),document.addEventListener("touchend",this.touchEndCallback,{passive:!1}),this.scrim.addEventListener("click",this.scrimClickCallback)}},{key:"removeEventListeners",value:function(){document.removeEventListener("touchstart",this.touchStartCallback,{passive:!1}),document.removeEventListener("touchmove",this.touchMoveCallback,{passive:!1}),document.removeEventListener("touchend",this.touchEndCallback,{passive:!1}),this.scrim.removeEventListener("click",this.scrimClickCallback)}},{key:"requestAnimationLoop",value:function(){this.animationFrameRequested||(this.animationFrameRequested=!0,requestAnimationFrame(this.animationFrameCallback))}},{key:"getNearestTouch",value:function(touches){var _this3=this;return 1===touches.length?touches[0]:Array.prototype.reduce.call(touches,function(acc,touch){var dist=(0,_common.pageDist)(_this3,touch);return dist<acc.dist?{dist:dist,touch:touch}:acc},{dist:Number.POSITIVE_INFINITY,touch:null}).touch}},{key:"touchStartCallback",value:function(e){if(1===e.touches.length){this.isScrolling=void 0;var touch=e.touches[0];this.startX=touch.pageX,this.startY=touch.pageY,this.pageX=touch.pageX,this.pageY=touch.pageY,this.lastPageX=touch.pageX,this.lastPageY=touch.pageY,(this.opened||this.pageX<window.innerWidth/3)&&(this.prepInteraction(),this.touching=!0,this.loopState=TOUCHING)}}},{key:"touchMoveCallback",value:function(e){if(this.touching){var touch=this.getNearestTouch(e.touches);if(this.pageX=touch.pageX,this.pageY=touch.pageY,void 0===this.isScrolling&&this.startedMoving&&(this.isScrolling=Math.abs(this.startY-this.pageY)>Math.abs(this.startX-this.pageX),this.isScrolling||(this.loopState=TOUCHING,this.requestAnimationLoop())),this.isScrolling)return;e.preventDefault(),this.startedMoving=!0}}},{key:"updateMenuOpen",value:function(){this.velocity>.2?this.setState("opened",!0):this.velocity<-.2?this.setState("opened",!1):this.translateX>=this.sliderWidth/2?this.setState("opened",!0):this.setState("opened",!1)}},{key:"touchEndCallback",value:function(e){if(this.touching){if(this.isScrolling||e.touches.length>0)return;this.startedMoving&&this.updateMenuOpen(),this.opened?this.scrim.style.pointerEvents="all":this.scrim.style.pointerEvents="",this.loopState=START_ANIMATING,this.startedMoving=!1,this.touching=!1}}},{key:"scrimClickCallback",value:function(){this.close()}},{key:"prepInteraction",value:function(){this.content.style.willChange="transform",this.scrim.style.willChange="opacity",this.content.classList.remove("y-drawer-opened"),this.sliderWidth=this.getMovableSliderWidth()}},{key:"getMovableSliderWidth",value:function(){return-this.content.offsetLeft}},{key:"animateTo",value:function(opened){this.prepInteraction(),this.setState("opened",opened),this.loopState=START_ANIMATING,this.requestAnimationLoop()}},{key:"jumpTo",value:function(opened){this.prepInteraction(),this.setState("opened",opened),this.loopState=IDLE,this.startTranslateX=opened*this.sliderWidth,this.endAnimating(),this.updateDOM(this.startTranslateX,this.sliderWidth)}},{key:"updateTranslateX",value:function(){var deltaX=this.pageX-this.startX;return this.translateX=this.startTranslateX+deltaX,this.translateX=Math.max(0,Math.min(this.sliderWidth,this.translateX)),deltaX}},{key:"animationFrameCallback",value:function(time){switch(this.loopState){case TOUCHING:this.touchingFrame(time);break;case START_ANIMATING:this.startAnimatingFrame(time),this.loopState=ANIMATING,this.animationFrameCallback(time);break;case ANIMATING:this.animatingFrame(time)}}},{key:"touchingFrame",value:function(time){var timeDiff=time-this.lastTime;if(timeDiff>0){var pageXDiff=this.pageX-this.lastPageX;this.velocity=pageXDiff/timeDiff*.8+(1-.8)*this.velocity}this.updateTranslateX(),this.updateDOM(this.translateX,this.sliderWidth),this.lastTime=time,this.lastPageX=this.pageX,this.lastPageY=this.pageY,requestAnimationFrame(this.animationFrameCallback)}},{key:"startAnimatingFrame",value:function(time){this.updateTranslateX();var animation={};animation.startX=this.translateX,animation.endX=(this.opened?1:0)*this.sliderWidth,animation.changeInValue=animation.endX-animation.startX,animation.startTime=time,this.animation=animation}},{key:"animatingFrame",value:function(time){var timeInAnimation=time-this.animation.startTime;timeInAnimation<this.transitionDuration?this.animatingCont(timeInAnimation):this.animatingEnd(),this.updateDOM(this.startTranslateX,this.sliderWidth)}},{key:"animatingCont",value:function(timeInAnimation){var startValue=this.animation.startX,changeInValue=this.animation.changeInValue;this.startTranslateX=(0,_common.linearTween)(timeInAnimation,startValue,changeInValue,this.transitionDuration),requestAnimationFrame(this.animationFrameCallback)}},{key:"animatingEnd",value:function(){this.startTranslateX=this.animation.endX,delete this.animation,this.endAnimating()}},{key:"endAnimating",value:function(){this.animationFrameRequested=!1,this.loopState=IDLE,this.velocity=0,this.opened?(this.scrim.style.pointerEvents="all",this.content.classList.add("y-drawer-opened")):this.scrim.style.pointerEvents="",this.content.style.willChange="",this.scrim.style.willChange="",this.fireEvent("transitioned")}},{key:"updateDOM",value:function(translateX,sliderWidth){this.content.style.transform="translateX("+translateX+"px)",this.scrim.style.opacity=translateX/sliderWidth}},{key:"close",value:function(){return this.animateTo(!1),this}},{key:"open",value:function(){return this.animateTo(!0),this}},{key:"toggle",value:function(){return this.opened?this.close():this.open(),this}},{key:"persist",value:function(){this.scrim.style.display="none",this.removeEventListeners(),this.setState("persistent",!0)}},{key:"unpersist",value:function(){this.scrim.style.display="",this.addEventListeners(),this.setState("persistent",!1)}}]),_class}((0,_componentCore3.default)(C))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../common":2,"y-component/src/component-core":1}],4:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!==(void 0===call?"undefined":_typeof(call))&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+(void 0===superClass?"undefined":_typeof(superClass)));subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function fragmentFromString(strHTML){return document.createRange().createContextualFragment(strHTML)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../core"),_core2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_core),Drawer=function(_drawerCore){function Drawer(el,props){_classCallCheck(this,Drawer);var _this=_possibleConstructorReturn(this,(Drawer.__proto__||Object.getPrototypeOf(Drawer)).call(this));return _this.setupComponent(el,props),_this}return _inherits(Drawer,_drawerCore),_createClass(Drawer,[{key:"setupDOM",value:function(el){if(!el)throw Error("No element provided");var scrim=document.createElement("div");scrim.classList.add("y-drawer-scrim");var content=document.createElement("div");for(content.classList.add("y-drawer-content");el.children.length>0;)content.appendChild(el.children[0]);el.appendChild(scrim),el.appendChild(content);var ref=document.getElementsByTagName("style")[0];return ref.parentNode.insertBefore(fragmentFromString("\n<style>\n@media screen {\n  .y-drawer-scrim {\n    display: block;\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    opacity: 0;\n    z-index: 0;\n    pointer-events: none;\n    transform: translate3d(0,0,0);\n    -webkit-tap-highlight-color: transparent;\n\n    background: rgba(0, 0, 0, 0.67);\n  }\n\n  .y-drawer-content {\n    position: fixed;\n    left: 0;\n    bottom: 0;\n    top: 0;\n    z-index: 1;\n    overflow-x: hidden;\n    overflow-y: auto;\n    transform: translate3d(0,0,0);\n    -webkit-overflow-scrolling: touch;\n    contain: strict;\n\n    left: -18rem;\n    width: 18rem;\n    background: #e8e8e8;\n  }\n\n  .y-drawer-content.y-drawer-opened {\n    left: 0!important;\n    transform: translate3d(0,0,0)!important;\n  }\n}\n\n@media print {\n  .y-drawer-scrim {\n    display: none!important;\n  }\n\n  .y-drawer-content {\n    transform: none!important;\n  }\n}\n\n</style>"),ref),el}}]),Drawer}((0,_core2.default)());exports.default=Drawer},{"../core":3}]},{},[4])(4)});